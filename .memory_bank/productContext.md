# Продуктовый Контекст

## Проблемы, которые решает проект

1. **Создание пользовательских карт**: Предоставляет инструмент для создания и редактирования гексагональных карт для стратегических игр
2. **3D визуализация**: Позволяет визуализировать карты в 3D с использованием реальных моделей перед экспортом
3. **Удобство редактирования**: Предоставляет современный интерфейс с горячими клавишами, множественным выделением и undo/redo
4. **LLM-совместимость**: Использует осевые координаты (q, r) для совместимости с LLM-генерацией карт

## User Stories

### Создатель карт (Map Creator)

- Как создатель карт, я хочу создавать пользовательские гексагональные карты с помощью 3D редактора
- Как создатель карт, я хочу размещать различные типы местности (леса, горы, равнины, вода, дороги)
- Как создатель карт, я хочу размещать здания и декорации на карте
- Как создатель карт, я хочу создавать многоуровневые ландшафты (до 5 уровней высоты)
- Как создатель карт, я хочу копировать и вставлять тайлы для быстрого заполнения карты (Ctrl+C, Ctrl+V)
- Как создатель карт, я хочу выделять несколько тайлов одновременно для массового редактирования (Ctrl+ЛКМ)
- Как создатель карт, я хочу отменять и повторять действия при редактировании (Ctrl+Z, Ctrl+Y)
- Как создатель карт, я хочу сохранять и загружать созданные карты
- Как создатель карт, я хочу видеть карту в 3D с реальными моделями во время редактирования
- Как создатель карт, я хочу видеть превью моделей перед размещением
- Как создатель карт, я хочу перемещать тайлы по карте перетаскиванием
- Как создатель карт, я хочу изменять уровень высоты тайлов (R/F клавиши)
- Как создатель карт, я хочу вращать тайлы (правый клик)

## Принципы UX/UI

1. **Ясность**: Интерфейс интуитивно понятен, минимум обучения
2. **Информативность**: Пользователь всегда видит важную информацию (выбранный тайл, уровень высоты, режим редактирования)
3. **Визуальная привлекательность**: Современный дизайн с Shadcn/ui компонентами
4. **Производительность**: Плавная работа даже на средних устройствах
5. **Темная тема**: По умолчанию для комфортной работы
6. **Горячие клавиши**: Быстрый доступ к часто используемым функциям

## Приоритеты при принятии решений

- **Удобство интерфейса** > Скорость разработки
- **Производительность рендеринга** > Визуальные эффекты
- **Стабильность** > Новые фичи
- **Читаемость кода** > Оптимизация на микроуровне
- **LLM-совместимость** > Обратная совместимость со старым форматом

## Функциональные Требования (Glossary)

- **Map**: Игровая карта с гексагональной сеткой
- **Hex**: Отдельный гекс (тайл) на карте с координатами (q, r)
- **Terrain**: Тип местности (равнины, леса, горы, вода, дороги)
- **Building**: Здание или декорация, размещаемая на тайле
- **Level**: Уровень высоты тайла (0-4)
- **Stack**: Стопка тайлов на одной позиции (разные уровни)
- **Selection**: Выделенные тайлы для операций редактирования
- **History**: История изменений для undo/redo операций
- **Clipboard**: Буфер обмена для копирования/вставки тайлов

## Ключевые Функциональные Требования

### Создание и Редактирование Карты

- Инициализация новой карты с выбором размера (small, medium, large, very-large)
- Размещение тайлов местности на карте
- Размещение зданий и декораций на тайлах
- Создание многоуровневых ландшафтов (до 5 уровней)
- Удаление тайлов (Delete клавиша)
- Перемещение тайлов перетаскиванием
- Изменение уровня высоты тайлов (R/F клавиши)
- Вращение тайлов (правый клик)

### Выделение и Выбор

- Одиночное выделение тайла (левый клик)
- Множественное выделение тайлов (Ctrl+ЛКМ)
- Выбор верхнего тайла в стопке автоматически
- Визуальное выделение выбранных тайлов (рамка)

### Операции с Тайлами

- Копирование тайлов (Ctrl+C)
- Вставка тайлов (Ctrl+V) в позицию курсора мыши
- Сохранение относительной высоты при вставке
- Множественное копирование/вставка выделенных тайлов

### История и Отмена

- Отмена операций (Ctrl+Z)
- Повтор операций (Ctrl+Y или Ctrl+Shift+Z)
- История до 50 состояний
- Сохранение состояния до и после операций редактирования

### Сохранение и Загрузка

- Сохранение карты в JSON формат (локально)
- Загрузка сохраненных карт
- Валидация формата файла при загрузке
- Поддержка версионирования формата (миграция формата 1.0 → 2.0)
- Метаданные карты (имя, дата создания)

### Интерфейс и Управление

- Point-and-click интерфейс для всех действий
- Горячие клавиши для частых действий
- Информационные панели с выбором тайлов и зданий
- Превью моделей перед размещением
- Управление камерой (вращение, панорамирование, зум)
