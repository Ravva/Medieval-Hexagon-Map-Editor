# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è LLM –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞**: 2025-12-27
**–ú–æ–¥–µ–ª—å**: Gemini 2.5 Flash
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **API**: Google Gemini 2.5 Flash
- **–õ–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤**: 1,048,576 input / 65,536 output
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON Schema**: ‚úÖ –î–∞ (—á–µ—Ä–µ–∑ `responseMimeType` –∏ `responseSchema`)

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¢–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ‚úÖ

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–ø–µ—à–Ω–æ
- API –∫–ª—é—á –∑–∞–≥—Ä—É–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ `gemini-2.5-flash` —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –¢–µ—Å—Ç 2: JSON Schema ‚úÖ

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ JSON Schema

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–ø–µ—à–Ω–æ
- JSON Schema –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –í—Å–µ –ø–æ–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–µ–º–µ

**–°—Ö–µ–º–∞ —Ç–µ—Å—Ç–∞**:
```json
{
  "message": "string",
  "status": "success" | "error",
  "data": {
    "testNumber": "number",
    "testBoolean": "boolean"
  }
}
```

### –¢–µ—Å—Ç 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–∞ Hex –∫–∞—Ä—Ç—ã ‚úÖ

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–ø–µ—à–Ω–æ

**–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞** (3x3):
- ‚úÖ –í—Å–µ 9 –≥–µ–∫—Å–æ–≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (q: 0-2, r: 0-2)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (q, r)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ tile_id ("tiles_base_hex_grass", "tiles_base_hex_water")
- ‚úÖ –í–æ–¥–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ (q=1, r=1) –∫–∞–∫ –∑–∞–ø—Ä–æ—à–µ–Ω–æ
- ‚úÖ –¢—Ä–∞–≤–∞ –≤–æ–∫—Ä—É–≥ —Ü–µ–Ω—Ç—Ä–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è rotation (0, 60, 120, 180, 240, 300)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è height (0)

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**:
```json
{
  "hexes": [
    {"q": 0, "r": 0, "tile_id": "tiles_base_hex_grass", "rotation": 0, "height": 0},
    {"q": 0, "r": 1, "tile_id": "tiles_base_hex_grass", "rotation": 60, "height": 0},
    {"q": 0, "r": 2, "tile_id": "tiles_base_hex_grass", "rotation": 120, "height": 0},
    {"q": 1, "r": 0, "tile_id": "tiles_base_hex_grass", "rotation": 180, "height": 0},
    {"q": 1, "r": 1, "tile_id": "tiles_base_hex_water", "rotation": 240, "height": 0},
    {"q": 1, "r": 2, "tile_id": "tiles_base_hex_grass", "rotation": 300, "height": 0},
    {"q": 2, "r": 0, "tile_id": "tiles_base_hex_grass", "rotation": 0, "height": 0},
    {"q": 2, "r": 1, "tile_id": "tiles_base_hex_grass", "rotation": 60, "height": 0},
    {"q": 2, "r": 2, "tile_id": "tiles_base_hex_grass", "rotation": 120, "height": 0}
  ]
}
```

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Gemini API

### 1. `additionalProperties` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–µ `additionalProperties: false` –≤ JSON Schema –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É 400

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞—Ç—å `additionalProperties` –∏–∑ –≤—Å–µ—Ö —Å—Ö–µ–º

**–ü—Ä–∏–º–µ—Ä**:
```typescript
// ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
{
  type: "object",
  properties: {...},
  additionalProperties: false
}

// ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
{
  type: "object",
  properties: {...}
}
```

### 2. `enum` —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—Ä–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞**: `enum` —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É 400

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `minimum`/`maximum` –¥–ª—è —á–∏—Å–µ–ª –∏ —É–∫–∞–∑—ã–≤–∞—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—Ä–æ–º–ø—Ç–µ

**–ü—Ä–∏–º–µ—Ä**:
```typescript
// ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
{
  rotation: { type: "integer", enum: [0, 60, 120, 180, 240, 300] }
}

// ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
{
  rotation: { type: "integer", minimum: 0, maximum: 300 }
}
// + –≤ –ø—Ä–æ–º–ø—Ç–µ: "Rotation must be one of: 0, 60, 120, 180, 240, or 300 degrees"
```

## –í—ã–≤–æ–¥—ã

1. ‚úÖ **API –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**: Gemini 2.5 Flash –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
2. ‚úÖ **JSON Schema —Ä–∞–±–æ—Ç–∞–µ—Ç**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç**: LLM —É—Å–ø–µ—à–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≥–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã
4. ‚úÖ **–õ–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã**: 1M input —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –±–æ–ª—å—à–æ–π —Ä–µ–µ—Å—Ç—Ä —Ç–∞–π–ª–æ–≤
5. ‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã**: –ù—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è JSON Schema –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ö–µ–º

## –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

1. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
2. üìã –°–æ–∑–¥–∞—Ç—å AssetAnalyzer –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 3D-–∞—Å—Å–µ—Ç–æ–≤
3. üìã –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–µ—Å—Ç—Ä —Ç–∞–π–ª–æ–≤ (Tile Registry)
4. üìã –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å MapGenerator —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
5. üìã –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ UI —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–∞—Ä—Ç

## –§–∞–π–ª—ã

- –¢–µ—Å—Ç–æ–≤—ã–µ endpoints: `app/api/llm/test/route.ts`
- –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `app/test-llm/page.tsx`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `docs/llm-integration-plan.md`, `docs/llm-api-testing.md`

